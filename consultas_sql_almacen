- 1 - Piezas rojas con peso mayor a 15

SELECT * 
FROM p
WHERE color = 'rojo' AND peso > 15;

- 2 - ciudades en las que hay proveedores y se almacena alguna pieza

SELECT DISTINCT ciudad
FROM s
WHERE ciudad IN (SELECT ciudad FROM p);

- 3 - ciudades en las que hay proveedores y no se almacenan piezas

SELECT DISTINCT ciudad
FROM s
WHERE ciudad NOT IN (SELECT ciudad FROM p);

- 4 - datos de los proveedores que envian la pieza P1 y cantidad que envian

SELECT s.*, cant
FROM s,sp
WHERE s.sn=sp.sn AND pn='p1';

- 5 -	Nombre de los proveedores que suministran la pieza con código P2, ordenados alfabéticamente.

a.	SELECT DISTINCT snombre FROM SP , S
WHERE SP.sn = S.sn AND pn='P2'
ORDER BY snombre;	

b.	SELECT DISTINCT snombre
FROM SP INNER JOIN S ON SP.sn = S.sn WHERE pn='P2'
ORDER BY snombre;

- 6 -	Nombre de los proveedores que suministran por lo menos una pieza  roja

SELECT DISTINCT snombre 
FROM SP , S , P
WHERE SP.sn = S.sn AND SP.pn = P.pn AND P.color = 'rojo';

- 7 -	Nombre de todas las piezas que empiecen por “P”.

a.  
SELECT DISTINCT pnombre
FROM P
WHERE pnombre LIKE 'p*';

b. SELECT DISTINCT pnombre
FROM P	
WHERE UPPER(pnombre) LIKE 'P*';	

c. SELECT DISTINCT pnombre
FROM P
WHERE LOWER(pnombre) LIKE 'p*';

- 8 -	Nombre y cantidad de todas las piezas enviadas por el proveedor con código  S3.

a.	
SELECT pnombre, cant 
FROM SP, P
WHERE SP.pn = P.pn AND SP.sn='S3';	

b.	
SELECT pnombre, cant
FROM SP INNER JOIN P ON SP.pn = P.pn WHERE SP.sn='S3';

- 9 -	Nombre de las piezas de color rojo suministradas por los proveedores de la ciudad de Londres.

SELECT DISTINCT pnombre 
FROM SP , S , P
WHERE SP.sn = S.sn AND SP.pn = P.pn AND P.color = 'rojo' AND S.ciudad = 'Londres';


- 10 -	Número total de unidades de piezas suministradas por cada proveedor.

SELECT sn AS “Proveedor”, SUM(cant) AS “Total” FROM SP
GROUP BY sn;


- 11 -	Número medio de unidades suministradas por envío.

SELECT AVG(cant) AS “Media” 
FROM SP ;

- 12 - Listado de las piezas cuyo peso supera las 12 unidades y cuyo nombre termina por la letra „o‟ ó por la letra „a‟. De cada pieza hay que mostrar su número, su nombre y su color. El listado debe aparecer ordenado por el color. Las que sean del mismo color deben salir ordenadas por peso descendentemente.

SELECT pn, pnombre, color FROM P
WHERE peso>12 AND (pnombre LIKE '*a' OR pnombre LIKE '*o') 
ORDER BY color ASC, peso DESC;

- 13 -	¿Cuántos tipos de piezas suministra el proveedor S2?

SELECT COUNT(pn) AS numpiezas
FROM SP
WHERE sn='S2';


- 14 - 	¿Cuántos proveedores suministran la pieza P2?

SELECT COUNT(sn) AS numproveedores FROM SP
WHERE pn='P2';


- 15- 	¿En cuántas ciudades se almacenan piezas?

SELECT COUNT (DISTINCT(ciudad)) AS “Nº ciudades” FROM P;

- 16 -	¿De cuántos colores tenemos piezas?

SELECT COUNT (DISTINCT(color)) AS “Nº colores” FROM P;
